
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>rdflib.plugins.sparql.parser &#8212; rdflib 6.2.0-alpha documentation</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/rtd.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../../../../../_static/searchtools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/RDFlib.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">rdflib 6.2.0-alpha documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">rdflib.plugins.sparql.parser</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for rdflib.plugins.sparql.parser</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">SPARQL 1.1 Parser</span>

<span class="sd">based on pyparsing</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">pyparsing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Literal</span><span class="p">,</span>
    <span class="n">Regex</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">OneOrMore</span><span class="p">,</span>
    <span class="n">ZeroOrMore</span><span class="p">,</span>
    <span class="n">Forward</span><span class="p">,</span>
    <span class="n">ParseException</span><span class="p">,</span>
    <span class="n">Suppress</span><span class="p">,</span>
    <span class="n">Combine</span><span class="p">,</span>
    <span class="n">restOfLine</span><span class="p">,</span>
    <span class="n">Group</span><span class="p">,</span>
    <span class="n">ParseResults</span><span class="p">,</span>
    <span class="n">delimitedList</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyparsing</span> <span class="kn">import</span> <span class="n">CaselessKeyword</span> <span class="k">as</span> <span class="n">Keyword</span>  <span class="c1"># watch out :)</span>

<span class="c1"># from pyparsing import Keyword as CaseSensitiveKeyword</span>

<span class="kn">from</span> <span class="nn">.parserutils</span> <span class="kn">import</span> <span class="n">Comp</span><span class="p">,</span> <span class="n">Param</span><span class="p">,</span> <span class="n">ParamList</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">operators</span> <span class="k">as</span> <span class="n">op</span>
<span class="kn">from</span> <span class="nn">rdflib.compat</span> <span class="kn">import</span> <span class="n">decodeUnicodeEscape</span>

<span class="kn">import</span> <span class="nn">rdflib</span>

<span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># ---------------- ACTIONS</span>


<div class="viewcode-block" id="neg"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.neg">[docs]</a><span class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="n">literal</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="o">-</span><span class="n">literal</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="n">literal</span><span class="o">.</span><span class="n">datatype</span><span class="p">)</span></div>


<div class="viewcode-block" id="setLanguage"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.setLanguage">[docs]</a><span class="k">def</span> <span class="nf">setLanguage</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lang</span><span class="o">=</span><span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="setDataType"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.setDataType">[docs]</a><span class="k">def</span> <span class="nf">setDataType</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">terms</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="expandTriples"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.expandTriples">[docs]</a><span class="k">def</span> <span class="nf">expandTriples</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expand ; and , syntax for repeat predicates, subjects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># import pdb; pdb.set_trace()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Terms&quot;</span><span class="p">,</span> <span class="n">terms</span><span class="p">)</span>
        <span class="n">l_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;,&quot;</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="ow">or</span> <span class="n">terms</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;;&quot;</span> <span class="ow">or</span> <span class="n">terms</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># this semicolon is spurious</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># BlankNodePropertyList</span>
                <span class="c1"># is this bnode the object of previous triples?</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1"># is this a single [] ?</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">+=</span> <span class="n">t</span>
                <span class="c1"># is this bnode the subject of more triples?</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">l_</span> <span class="ow">and</span> <span class="n">terms</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">&quot;.,;&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ParseResults</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">+=</span> <span class="n">t</span><span class="o">.</span><span class="n">asList</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">t</span> <span class="o">!=</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">json</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">res</span>
        <span class="c1"># print res</span>
        <span class="c1"># assert len(res)%3 == 0, \</span>
        <span class="c1">#       &quot;Length of triple-list is not divisible by 3: %d!&quot;%len(res)</span>

        <span class="c1"># return [tuple(res[i:i+3]) for i in range(len(res)/3)]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">traceback</span>

            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
        <span class="k">raise</span></div>


<div class="viewcode-block" id="expandBNodeTriples"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.expandBNodeTriples">[docs]</a><span class="k">def</span> <span class="nf">expandBNodeTriples</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    expand [ ?p ?o ] syntax for implicit bnodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># import pdb; pdb.set_trace()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bnode terms&quot;</span><span class="p">,</span> <span class="n">terms</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">rdflib</span><span class="o">.</span><span class="n">BNode</span><span class="p">()]</span> <span class="o">+</span> <span class="n">terms</span><span class="o">.</span><span class="n">asList</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">expandTriples</span><span class="p">([</span><span class="n">rdflib</span><span class="o">.</span><span class="n">BNode</span><span class="p">()]</span> <span class="o">+</span> <span class="n">terms</span><span class="o">.</span><span class="n">asList</span><span class="p">()[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span></div>


<div class="viewcode-block" id="expandCollection"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.expandCollection">[docs]</a><span class="k">def</span> <span class="nf">expandCollection</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    expand ( 1 2 3 ) notation for collections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Collection: &quot;</span><span class="p">,</span> <span class="n">terms</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">other</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># is this a [ .. ] ?</span>
            <span class="n">other</span> <span class="o">+=</span> <span class="n">x</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">BNode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">nil</span><span class="p">]</span>

    <span class="n">res</span> <span class="o">+=</span> <span class="n">other</span>

    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CollectionOut&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">res</span><span class="p">]</span></div>


<span class="c1"># SPARQL Grammar from http://www.w3.org/TR/sparql11-query/#grammar</span>
<span class="c1"># ------ TERMINALS --------------</span>
<span class="c1"># [139] IRIREF ::= &#39;&lt;&#39; ([^&lt;&gt;&quot;{}|^`\]-[#x00-#x20])* &#39;&gt;&#39;</span>
<span class="n">IRIREF</span> <span class="o">=</span> <span class="n">Combine</span><span class="p">(</span>
    <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^&lt;&gt;&quot;</span><span class="si">{}</span><span class="s1">|^`</span><span class="se">\\</span><span class="si">%s</span><span class="s1">]*&#39;</span> <span class="o">%</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">x</span><span class="si">%02X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">33</span><span class="p">)))</span>
    <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">IRIREF</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">URIRef</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># [164] P_CHARS_BASE ::= [A-Z] | [a-z] | [#x00C0-#x00D6] | [#x00D8-#x00F6] | [#x00F8-#x02FF] | [#x0370-#x037D] | [#x037F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxunicode</span> <span class="o">==</span> <span class="mh">0xFFFF</span><span class="p">:</span>
    <span class="c1"># this is narrow python build (default on windows/osx)</span>
    <span class="c1"># this means that unicode code points over 0xffff are stored</span>
    <span class="c1"># as several characters, which in turn means that regex character</span>
    <span class="c1"># ranges with these characters do not work.</span>
    <span class="c1"># See</span>
    <span class="c1"># * http://bugs.python.org/issue12729</span>
    <span class="c1"># * http://bugs.python.org/issue12749</span>
    <span class="c1"># * http://bugs.python.org/issue3665</span>
    <span class="c1">#</span>
    <span class="c1"># Here we simple skip the [#x10000-#xEFFFF] part</span>
    <span class="c1"># this means that some SPARQL queries will not parse :(</span>
    <span class="c1"># We *could* generate a new regex with \U00010000|\U00010001 ...</span>
    <span class="c1"># but it would be quite long :)</span>
    <span class="c1">#</span>
    <span class="c1"># in py3.3 this is fixed</span>

    <span class="n">PN_CHARS_BASE_re</span> <span class="o">=</span> <span class="s2">&quot;A-Za-z</span><span class="se">\u00C0</span><span class="s2">-</span><span class="se">\u00D6\u00D8</span><span class="s2">-</span><span class="se">\u00F6\u00F8</span><span class="s2">-</span><span class="se">\u02FF\u0370</span><span class="s2">-</span><span class="se">\u037D\u037F</span><span class="s2">-</span><span class="se">\u1FFF\u200C</span><span class="s2">-</span><span class="se">\u200D\u2070</span><span class="s2">-</span><span class="se">\u218F\u2C00</span><span class="s2">-</span><span class="se">\u2FEF\u3001</span><span class="s2">-</span><span class="se">\uD7FF\uF900</span><span class="s2">-</span><span class="se">\uFDCF\uFDF0</span><span class="s2">-</span><span class="se">\uFFFD</span><span class="s2">&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># wide python build</span>
    <span class="n">PN_CHARS_BASE_re</span> <span class="o">=</span> <span class="s2">&quot;A-Za-z</span><span class="se">\u00C0</span><span class="s2">-</span><span class="se">\u00D6\u00D8</span><span class="s2">-</span><span class="se">\u00F6\u00F8</span><span class="s2">-</span><span class="se">\u02FF\u0370</span><span class="s2">-</span><span class="se">\u037D\u037F</span><span class="s2">-</span><span class="se">\u1FFF\u200C</span><span class="s2">-</span><span class="se">\u200D\u2070</span><span class="s2">-</span><span class="se">\u218F\u2C00</span><span class="s2">-</span><span class="se">\u2FEF\u3001</span><span class="s2">-</span><span class="se">\uD7FF\uF900</span><span class="s2">-</span><span class="se">\uFDCF\uFDF0</span><span class="s2">-</span><span class="se">\uFFFD\U00010000</span><span class="s2">-</span><span class="se">\U000EFFFF</span><span class="s2">&quot;</span>

<span class="c1"># [165] PN_CHARS_U ::= PN_CHARS_BASE | &#39;_&#39;</span>
<span class="n">PN_CHARS_U_re</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">PN_CHARS_BASE_re</span>

<span class="c1"># [167] PN_CHARS ::= PN_CHARS_U | &#39;-&#39; | [0-9] | #x00B7 | [#x0300-#x036F] | [#x203F-#x2040]</span>
<span class="n">PN_CHARS_re</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">-0-9</span><span class="se">\u00B7\u0300</span><span class="s2">-</span><span class="se">\u036F\u203F</span><span class="s2">-</span><span class="se">\u2040</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">PN_CHARS_U_re</span>
<span class="c1"># PN_CHARS = Regex(u&#39;[%s]&#39;%PN_CHARS_re, flags=re.U)</span>

<span class="c1"># [168] PN_PREFIX ::= PN_CHARS_BASE ((PN_CHARS|&#39;.&#39;)* PN_CHARS)?</span>
<span class="n">PN_PREFIX</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span>
    <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">](?:[</span><span class="si">%s</span><span class="se">\\</span><span class="s2">.]*[</span><span class="si">%s</span><span class="s2">])?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PN_CHARS_BASE_re</span><span class="p">,</span> <span class="n">PN_CHARS_re</span><span class="p">,</span> <span class="n">PN_CHARS_re</span><span class="p">),</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">U</span>
<span class="p">)</span>

<span class="c1"># [140] PNAME_NS ::= PN_PREFIX? &#39;:&#39;</span>
<span class="n">PNAME_NS</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="n">PN_PREFIX</span><span class="p">))</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>

<span class="c1"># [173] PN_LOCAL_ESC ::= &#39;\&#39; ( &#39;_&#39; | &#39;~&#39; | &#39;.&#39; | &#39;-&#39; | &#39;!&#39; | &#39;$&#39; | &#39;&amp;&#39; | &quot;&#39;&quot; | &#39;(&#39; | &#39;)&#39; | &#39;*&#39; | &#39;+&#39; | &#39;,&#39; | &#39;;&#39; | &#39;=&#39; | &#39;/&#39; | &#39;?&#39; | &#39;#&#39; | &#39;@&#39; | &#39;%&#39; )</span>

<span class="n">PN_LOCAL_ESC_re</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">[_~</span><span class="se">\\</span><span class="s2">.</span><span class="se">\\</span><span class="s2">-!$&amp;</span><span class="se">\&quot;</span><span class="s2">&#39;()*+,;=/?#@%]&quot;</span>
<span class="c1"># PN_LOCAL_ESC = Regex(PN_LOCAL_ESC_re) # regex&#39;d</span>
<span class="c1"># PN_LOCAL_ESC.setParseAction(lambda x: x[0][1:])</span>

<span class="c1"># [172] HEX ::= [0-9] | [A-F] | [a-f]</span>
<span class="c1"># HEX = Regex(&#39;[0-9A-Fa-f]&#39;) # not needed</span>

<span class="c1"># [171] PERCENT ::= &#39;%&#39; HEX HEX</span>
<span class="n">PERCENT_re</span> <span class="o">=</span> <span class="s2">&quot;%[0-9a-fA-F]</span><span class="si">{2}</span><span class="s2">&quot;</span>
<span class="c1"># PERCENT = Regex(PERCENT_re) # regex&#39;d</span>
<span class="c1"># PERCENT.setParseAction(lambda x: chr(int(x[0][1:], 16)))</span>

<span class="c1"># [170] PLX ::= PERCENT | PN_LOCAL_ESC</span>
<span class="n">PLX_re</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">|</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PN_LOCAL_ESC_re</span><span class="p">,</span> <span class="n">PERCENT_re</span><span class="p">)</span>
<span class="c1"># PLX = PERCENT | PN_LOCAL_ESC # regex&#39;d</span>


<span class="c1"># [169] PN_LOCAL ::= (PN_CHARS_U | &#39;:&#39; | [0-9] | PLX ) ((PN_CHARS | &#39;.&#39; | &#39;:&#39; | PLX)* (PN_CHARS | &#39;:&#39; | PLX) )?</span>

<span class="n">PN_LOCAL</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;([%(PN_CHARS_U)s:0-9]|%(PLX)s)</span>
<span class="sd">                     (([%(PN_CHARS)s\\.:]|%(PLX)s)*</span>
<span class="sd">                      ([%(PN_CHARS)s:]|%(PLX)s) )?&quot;&quot;&quot;</span>
    <span class="o">%</span> <span class="nb">dict</span><span class="p">(</span><span class="n">PN_CHARS_U</span><span class="o">=</span><span class="n">PN_CHARS_U_re</span><span class="p">,</span> <span class="n">PN_CHARS</span><span class="o">=</span><span class="n">PN_CHARS_re</span><span class="p">,</span> <span class="n">PLX</span><span class="o">=</span><span class="n">PLX_re</span><span class="p">),</span>
    <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">X</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">_hexExpand</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>


<span class="n">PN_LOCAL</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">PERCENT_re</span><span class="p">,</span> <span class="n">_hexExpand</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


<span class="c1"># [141] PNAME_LN ::= PNAME_NS PN_LOCAL</span>
<span class="n">PNAME_LN</span> <span class="o">=</span> <span class="n">PNAME_NS</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;localname&quot;</span><span class="p">,</span> <span class="n">PN_LOCAL</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">())</span>

<span class="c1"># [142] BLANK_NODE_LABEL ::= &#39;_:&#39; ( PN_CHARS_U | [0-9] ) ((PN_CHARS|&#39;.&#39;)* PN_CHARS)?</span>
<span class="n">BLANK_NODE_LABEL</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span>
    <span class="s2">&quot;_:[0-9</span><span class="si">%s</span><span class="s2">](?:[</span><span class="se">\\</span><span class="s2">.</span><span class="si">%s</span><span class="s2">]*[</span><span class="si">%s</span><span class="s2">])?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PN_CHARS_U_re</span><span class="p">,</span> <span class="n">PN_CHARS_re</span><span class="p">,</span> <span class="n">PN_CHARS_re</span><span class="p">),</span>
    <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">U</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">BLANK_NODE_LABEL</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">BNode</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:]))</span>


<span class="c1"># [166] VARNAME ::= ( PN_CHARS_U | [0-9] ) ( PN_CHARS_U | [0-9] | #x00B7 | [#x0300-#x036F] | [#x203F-#x2040] )*</span>
<span class="n">VARNAME</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span>
    <span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">0-9][</span><span class="si">%s</span><span class="s2">0-9</span><span class="se">\u00B7\u0300</span><span class="s2">-</span><span class="se">\u036F\u203F</span><span class="s2">-</span><span class="se">\u2040</span><span class="s2">]*&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PN_CHARS_U_re</span><span class="p">,</span> <span class="n">PN_CHARS_U_re</span><span class="p">),</span>
    <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">U</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [143] VAR1 ::= &#39;?&#39; VARNAME</span>
<span class="n">VAR1</span> <span class="o">=</span> <span class="n">Combine</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">VARNAME</span><span class="p">)</span>

<span class="c1"># [144] VAR2 ::= &#39;$&#39; VARNAME</span>
<span class="n">VAR2</span> <span class="o">=</span> <span class="n">Combine</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">VARNAME</span><span class="p">)</span>

<span class="c1"># [145] LANGTAG ::= &#39;@&#39; [a-zA-Z]+ (&#39;-&#39; [a-zA-Z0-9]+)*</span>
<span class="n">LANGTAG</span> <span class="o">=</span> <span class="n">Combine</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Regex</span><span class="p">(</span><span class="s2">&quot;[a-zA-Z]+(?:-[a-zA-Z0-9]+)*&quot;</span><span class="p">))</span>

<span class="c1"># [146] INTEGER ::= [0-9]+</span>
<span class="n">INTEGER</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]+&quot;</span><span class="p">)</span>
<span class="c1"># INTEGER.setResultsName(&#39;integer&#39;)</span>
<span class="n">INTEGER</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">rdflib</span><span class="o">.</span><span class="n">XSD</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>

<span class="c1"># [155] EXPONENT ::= [eE] [+-]? [0-9]+</span>
<span class="n">EXPONENT_re</span> <span class="o">=</span> <span class="s2">&quot;[eE][+-]?[0-9]+&quot;</span>

<span class="c1"># [147] DECIMAL ::= [0-9]* &#39;.&#39; [0-9]+</span>
<span class="n">DECIMAL</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]*\.[0-9]+&quot;</span><span class="p">)</span>  <span class="c1"># (?![eE])</span>
<span class="c1"># DECIMAL.setResultsName(&#39;decimal&#39;)</span>
<span class="n">DECIMAL</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">rdflib</span><span class="o">.</span><span class="n">XSD</span><span class="o">.</span><span class="n">decimal</span><span class="p">))</span>

<span class="c1"># [148] DOUBLE ::= [0-9]+ &#39;.&#39; [0-9]* EXPONENT | &#39;.&#39; ([0-9])+ EXPONENT | ([0-9])+ EXPONENT</span>
<span class="n">DOUBLE</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[0-9]+\.[0-9]*</span><span class="si">%(e)s</span><span class="s2">|\.([0-9])+</span><span class="si">%(e)s</span><span class="s2">|[0-9]+</span><span class="si">%(e)s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="n">EXPONENT_re</span><span class="p">})</span>
<span class="c1"># DOUBLE.setResultsName(&#39;double&#39;)</span>
<span class="n">DOUBLE</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">rdflib</span><span class="o">.</span><span class="n">XSD</span><span class="o">.</span><span class="n">double</span><span class="p">))</span>


<span class="c1"># [149] INTEGER_POSITIVE ::= &#39;+&#39; INTEGER</span>
<span class="n">INTEGER_POSITIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">INTEGER</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>
<span class="n">INTEGER_POSITIVE</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">rdflib</span><span class="o">.</span><span class="n">XSD</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [150] DECIMAL_POSITIVE ::= &#39;+&#39; DECIMAL</span>
<span class="n">DECIMAL_POSITIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DECIMAL</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>

<span class="c1"># [151] DOUBLE_POSITIVE ::= &#39;+&#39; DOUBLE</span>
<span class="n">DOUBLE_POSITIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOUBLE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>

<span class="c1"># [152] INTEGER_NEGATIVE ::= &#39;-&#39; INTEGER</span>
<span class="n">INTEGER_NEGATIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">INTEGER</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>
<span class="n">INTEGER_NEGATIVE</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">neg</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># [153] DECIMAL_NEGATIVE ::= &#39;-&#39; DECIMAL</span>
<span class="n">DECIMAL_NEGATIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DECIMAL</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>
<span class="n">DECIMAL_NEGATIVE</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">neg</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># [154] DOUBLE_NEGATIVE ::= &#39;-&#39; DOUBLE</span>
<span class="n">DOUBLE_NEGATIVE</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DOUBLE</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>
<span class="n">DOUBLE_NEGATIVE</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">neg</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># [160] ECHAR ::= &#39;\&#39; [tbnrf\&quot;&#39;]</span>
<span class="c1"># ECHAR = Regex(&#39;\\\\[tbnrf&quot;\&#39;]&#39;)</span>


<span class="c1"># [158] STRING_LITERAL_LONG1 ::= &quot;&#39;&#39;&#39;&quot; ( ( &quot;&#39;&quot; | &quot;&#39;&#39;&quot; )? ( [^&#39;\] | ECHAR ) )* &quot;&#39;&#39;&#39;&quot;</span>
<span class="c1"># STRING_LITERAL_LONG1 = Literal(&quot;&#39;&#39;&#39;&quot;) + ( Optional( Literal(&quot;&#39;&quot;) | &quot;&#39;&#39;&quot;</span>
<span class="c1"># ) + ZeroOrMore( ~ Literal(&quot;&#39;\\&quot;) | ECHAR ) ) + &quot;&#39;&#39;&#39;&quot;</span>
<span class="n">STRING_LITERAL_LONG1</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;((?:&#39;|&#39;&#39;)?(?:[^&#39;</span><span class="se">\\\\</span><span class="s2">]|</span><span class="se">\\\\</span><span class="s2">[&#39;ntbrf</span><span class="se">\\\\</span><span class="s2">]))*&#39;&#39;&#39;&quot;</span><span class="p">)</span>
<span class="n">STRING_LITERAL_LONG1</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">decodeUnicodeEscape</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># [159] STRING_LITERAL_LONG2 ::= &#39;&quot;&quot;&quot;&#39; ( ( &#39;&quot;&#39; | &#39;&quot;&quot;&#39; )? ( [^&quot;\] | ECHAR ) )* &#39;&quot;&quot;&quot;&#39;</span>
<span class="c1"># STRING_LITERAL_LONG2 = Literal(&#39;&quot;&quot;&quot;&#39;) + ( Optional( Literal(&#39;&quot;&#39;) | &#39;&quot;&quot;&#39;</span>
<span class="c1"># ) + ZeroOrMore( ~ Literal(&#39;&quot;\\&#39;) | ECHAR ) ) +  &#39;&quot;&quot;&quot;&#39;</span>
<span class="n">STRING_LITERAL_LONG2</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="s1">&#39;&quot;&quot;&quot;(?:(?:&quot;|&quot;&quot;)?(?:[^&quot;</span><span class="se">\\\\</span><span class="s1">]|</span><span class="se">\\\\</span><span class="s1">[&quot;ntbrf</span><span class="se">\\\\</span><span class="s1">]))*&quot;&quot;&quot;&#39;</span><span class="p">)</span>
<span class="n">STRING_LITERAL_LONG2</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">decodeUnicodeEscape</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># [156] STRING_LITERAL1 ::= &quot;&#39;&quot; ( ([^#x27#x5C#xA#xD]) | ECHAR )* &quot;&#39;&quot;</span>
<span class="c1"># STRING_LITERAL1 = Literal(&quot;&#39;&quot;) + ZeroOrMore(</span>
<span class="c1"># Regex(u&#39;[^\u0027\u005C\u000A\u000D]&#39;,flags=re.U) | ECHAR ) + &quot;&#39;&quot;</span>

<span class="n">STRING_LITERAL1</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="s2">&quot;&#39;(?:[^&#39;</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\\\</span><span class="s2">]|</span><span class="se">\\\\</span><span class="s2">[&#39;ntbrf</span><span class="se">\\\\</span><span class="s2">])*&#39;(?!&#39;)&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
<span class="n">STRING_LITERAL1</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">decodeUnicodeEscape</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># [157] STRING_LITERAL2 ::= &#39;&quot;&#39; ( ([^#x22#x5C#xA#xD]) | ECHAR )* &#39;&quot;&#39;</span>
<span class="c1"># STRING_LITERAL2 = Literal(&#39;&quot;&#39;) + ZeroOrMore (</span>
<span class="c1"># Regex(u&#39;[^\u0022\u005C\u000A\u000D]&#39;,flags=re.U) | ECHAR ) + &#39;&quot;&#39;</span>

<span class="n">STRING_LITERAL2</span> <span class="o">=</span> <span class="n">Regex</span><span class="p">(</span><span class="s1">&#39;&quot;(?:[^&quot;</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">r</span><span class="se">\\\\</span><span class="s1">]|</span><span class="se">\\\\</span><span class="s1">[&quot;ntbrf</span><span class="se">\\\\</span><span class="s1">])*&quot;(?!&quot;)&#39;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">U</span><span class="p">)</span>
<span class="n">STRING_LITERAL2</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="n">decodeUnicodeEscape</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># [161] NIL ::= &#39;(&#39; WS* &#39;)&#39;</span>
<span class="n">NIL</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="n">NIL</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">nil</span><span class="p">)</span>

<span class="c1"># [162] WS ::= #x20 | #x9 | #xD | #xA</span>
<span class="c1"># Not needed?</span>
<span class="c1"># WS = #x20 | #x9 | #xD | #xA</span>
<span class="c1"># [163] ANON ::= &#39;[&#39; WS* &#39;]&#39;</span>
<span class="n">ANON</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
<span class="n">ANON</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">BNode</span><span class="p">())</span>

<span class="c1"># A = CaseSensitiveKeyword(&#39;a&#39;)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">RDF</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>


<span class="c1"># ------ NON-TERMINALS --------------</span>

<span class="c1"># [5] BaseDecl ::= &#39;BASE&#39; IRIREF</span>
<span class="n">BaseDecl</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Base&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BASE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;iri&quot;</span><span class="p">,</span> <span class="n">IRIREF</span><span class="p">))</span>

<span class="c1"># [6] PrefixDecl ::= &#39;PREFIX&#39; PNAME_NS IRIREF</span>
<span class="n">PrefixDecl</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;PrefixDecl&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PREFIX&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">PNAME_NS</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;iri&quot;</span><span class="p">,</span> <span class="n">IRIREF</span><span class="p">))</span>

<span class="c1"># [4] Prologue ::= ( BaseDecl | PrefixDecl )*</span>
<span class="n">Prologue</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">BaseDecl</span> <span class="o">|</span> <span class="n">PrefixDecl</span><span class="p">))</span>

<span class="c1"># [108] Var ::= VAR1 | VAR2</span>
<span class="n">Var</span> <span class="o">=</span> <span class="n">VAR1</span> <span class="o">|</span> <span class="n">VAR2</span>
<span class="n">Var</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># [137] PrefixedName ::= PNAME_LN | PNAME_NS</span>
<span class="n">PrefixedName</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;pname&quot;</span><span class="p">,</span> <span class="n">PNAME_LN</span> <span class="o">|</span> <span class="n">PNAME_NS</span><span class="p">)</span>

<span class="c1"># [136] iri ::= IRIREF | PrefixedName</span>
<span class="n">iri</span> <span class="o">=</span> <span class="n">IRIREF</span> <span class="o">|</span> <span class="n">PrefixedName</span>

<span class="c1"># [135] String ::= STRING_LITERAL1 | STRING_LITERAL2 | STRING_LITERAL_LONG1 | STRING_LITERAL_LONG2</span>
<span class="n">String</span> <span class="o">=</span> <span class="n">STRING_LITERAL_LONG1</span> <span class="o">|</span> <span class="n">STRING_LITERAL_LONG2</span> <span class="o">|</span> <span class="n">STRING_LITERAL1</span> <span class="o">|</span> <span class="n">STRING_LITERAL2</span>

<span class="c1"># [129] RDFLiteral ::= String ( LANGTAG | ( &#39;^^&#39; iri ) )?</span>

<span class="n">RDFLiteral</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;literal&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
        <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;lang&quot;</span><span class="p">,</span> <span class="n">LANGTAG</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">())</span>
        <span class="o">|</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;^^&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">()</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [132] NumericLiteralPositive ::= INTEGER_POSITIVE | DECIMAL_POSITIVE | DOUBLE_POSITIVE</span>
<span class="n">NumericLiteralPositive</span> <span class="o">=</span> <span class="n">DOUBLE_POSITIVE</span> <span class="o">|</span> <span class="n">DECIMAL_POSITIVE</span> <span class="o">|</span> <span class="n">INTEGER_POSITIVE</span>

<span class="c1"># [133] NumericLiteralNegative ::= INTEGER_NEGATIVE | DECIMAL_NEGATIVE | DOUBLE_NEGATIVE</span>
<span class="n">NumericLiteralNegative</span> <span class="o">=</span> <span class="n">DOUBLE_NEGATIVE</span> <span class="o">|</span> <span class="n">DECIMAL_NEGATIVE</span> <span class="o">|</span> <span class="n">INTEGER_NEGATIVE</span>

<span class="c1"># [131] NumericLiteralUnsigned ::= INTEGER | DECIMAL | DOUBLE</span>
<span class="n">NumericLiteralUnsigned</span> <span class="o">=</span> <span class="n">DOUBLE</span> <span class="o">|</span> <span class="n">DECIMAL</span> <span class="o">|</span> <span class="n">INTEGER</span>

<span class="c1"># [130] NumericLiteral ::= NumericLiteralUnsigned | NumericLiteralPositive | NumericLiteralNegative</span>
<span class="n">NumericLiteral</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">NumericLiteralUnsigned</span> <span class="o">|</span> <span class="n">NumericLiteralPositive</span> <span class="o">|</span> <span class="n">NumericLiteralNegative</span>
<span class="p">)</span>

<span class="c1"># [134] BooleanLiteral ::= &#39;true&#39; | &#39;false&#39;</span>
<span class="n">BooleanLiteral</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">|</span> <span class="n">Keyword</span><span class="p">(</span>
    <span class="s2">&quot;false&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">rdflib</span><span class="o">.</span><span class="n">Literal</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># [138] BlankNode ::= BLANK_NODE_LABEL | ANON</span>
<span class="n">BlankNode</span> <span class="o">=</span> <span class="n">BLANK_NODE_LABEL</span> <span class="o">|</span> <span class="n">ANON</span>

<span class="c1"># [109] GraphTerm ::= iri | RDFLiteral | NumericLiteral | BooleanLiteral | BlankNode | NIL</span>
<span class="n">GraphTerm</span> <span class="o">=</span> <span class="n">iri</span> <span class="o">|</span> <span class="n">RDFLiteral</span> <span class="o">|</span> <span class="n">NumericLiteral</span> <span class="o">|</span> <span class="n">BooleanLiteral</span> <span class="o">|</span> <span class="n">BlankNode</span> <span class="o">|</span> <span class="n">NIL</span>

<span class="c1"># [106] VarOrTerm ::= Var | GraphTerm</span>
<span class="n">VarOrTerm</span> <span class="o">=</span> <span class="n">Var</span> <span class="o">|</span> <span class="n">GraphTerm</span>

<span class="c1"># [107] VarOrIri ::= Var | iri</span>
<span class="n">VarOrIri</span> <span class="o">=</span> <span class="n">Var</span> <span class="o">|</span> <span class="n">iri</span>

<span class="c1"># [46] GraphRef ::= &#39;GRAPH&#39; iri</span>
<span class="n">GraphRef</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GRAPH&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graphiri&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span>

<span class="c1"># [47] GraphRefAll ::= GraphRef | &#39;DEFAULT&#39; | &#39;NAMED&#39; | &#39;ALL&#39;</span>
<span class="n">GraphRefAll</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">GraphRef</span>
    <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graphiri&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DEFAULT&quot;</span><span class="p">))</span>
    <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graphiri&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NAMED&quot;</span><span class="p">))</span>
    <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graphiri&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ALL&quot;</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># [45] GraphOrDefault ::= &#39;DEFAULT&#39; | &#39;GRAPH&#39;? iri</span>
<span class="n">GraphOrDefault</span> <span class="o">=</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DEFAULT&quot;</span><span class="p">))</span> <span class="o">|</span> <span class="n">Optional</span><span class="p">(</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GRAPH&quot;</span><span class="p">)</span>
<span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span>

<span class="c1"># [65] DataBlockValue ::= iri | RDFLiteral | NumericLiteral | BooleanLiteral | &#39;UNDEF&#39;</span>
<span class="n">DataBlockValue</span> <span class="o">=</span> <span class="n">iri</span> <span class="o">|</span> <span class="n">RDFLiteral</span> <span class="o">|</span> <span class="n">NumericLiteral</span> <span class="o">|</span> <span class="n">BooleanLiteral</span> <span class="o">|</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;UNDEF&quot;</span><span class="p">)</span>

<span class="c1"># [78] Verb ::= VarOrIri | A</span>
<span class="n">Verb</span> <span class="o">=</span> <span class="n">VarOrIri</span> <span class="o">|</span> <span class="n">A</span>


<span class="c1"># [85] VerbSimple ::= Var</span>
<span class="n">VerbSimple</span> <span class="o">=</span> <span class="n">Var</span>

<span class="c1"># [97] Integer ::= INTEGER</span>
<span class="n">Integer</span> <span class="o">=</span> <span class="n">INTEGER</span>


<span class="n">TriplesNode</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>
<span class="n">TriplesNodePath</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>

<span class="c1"># [104] GraphNode ::= VarOrTerm | TriplesNode</span>
<span class="n">GraphNode</span> <span class="o">=</span> <span class="n">VarOrTerm</span> <span class="o">|</span> <span class="n">TriplesNode</span>

<span class="c1"># [105] GraphNodePath ::= VarOrTerm | TriplesNodePath</span>
<span class="n">GraphNodePath</span> <span class="o">=</span> <span class="n">VarOrTerm</span> <span class="o">|</span> <span class="n">TriplesNodePath</span>


<span class="c1"># [93] PathMod ::= &#39;?&#39; | &#39;*&#39; | &#39;+&#39;</span>
<span class="n">PathMod</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="s2">&quot;*&quot;</span> <span class="o">|</span> <span class="s2">&quot;+&quot;</span>

<span class="c1"># [96] PathOneInPropertySet ::= iri | A | &#39;^&#39; ( iri | A )</span>
<span class="n">PathOneInPropertySet</span> <span class="o">=</span> <span class="n">iri</span> <span class="o">|</span> <span class="n">A</span> <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;InversePath&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">iri</span> <span class="o">|</span> <span class="n">A</span><span class="p">))</span>

<span class="n">Path</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>

<span class="c1"># [95] PathNegatedPropertySet ::= PathOneInPropertySet | &#39;(&#39; ( PathOneInPropertySet ( &#39;|&#39; PathOneInPropertySet )* )? &#39;)&#39;</span>
<span class="n">PathNegatedPropertySet</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;PathNegatedPropertySet&quot;</span><span class="p">,</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathOneInPropertySet</span><span class="p">)</span>
    <span class="o">|</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathOneInPropertySet</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathOneInPropertySet</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [94] PathPrimary ::= iri | A | &#39;!&#39; PathNegatedPropertySet | &#39;(&#39; Path &#39;)&#39; | &#39;DISTINCT&#39; &#39;(&#39; Path &#39;)&#39;</span>
<span class="n">PathPrimary</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">iri</span>
    <span class="o">|</span> <span class="n">A</span>
    <span class="o">|</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">PathNegatedPropertySet</span>
    <span class="o">|</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Path</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;DistinctPath&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DISTINCT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [91] PathElt ::= PathPrimary Optional(PathMod)</span>
<span class="n">PathElt</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;PathElt&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathPrimary</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;mod&quot;</span><span class="p">,</span> <span class="n">PathMod</span><span class="o">.</span><span class="n">leaveWhitespace</span><span class="p">())),</span>
<span class="p">)</span>

<span class="c1"># [92] PathEltOrInverse ::= PathElt | &#39;^&#39; PathElt</span>
<span class="n">PathEltOrInverse</span> <span class="o">=</span> <span class="n">PathElt</span> <span class="o">|</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;PathEltOrInverse&quot;</span><span class="p">,</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathElt</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [90] PathSequence ::= PathEltOrInverse ( &#39;/&#39; PathEltOrInverse )*</span>
<span class="n">PathSequence</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;PathSequence&quot;</span><span class="p">,</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathEltOrInverse</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathEltOrInverse</span><span class="p">)),</span>
<span class="p">)</span>


<span class="c1"># [89] PathAlternative ::= PathSequence ( &#39;|&#39; PathSequence )*</span>
<span class="n">PathAlternative</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;PathAlternative&quot;</span><span class="p">,</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathSequence</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">PathSequence</span><span class="p">)),</span>
<span class="p">)</span>

<span class="c1"># [88] Path ::= PathAlternative</span>
<span class="n">Path</span> <span class="o">&lt;&lt;=</span> <span class="n">PathAlternative</span>

<span class="c1"># [84] VerbPath ::= Path</span>
<span class="n">VerbPath</span> <span class="o">=</span> <span class="n">Path</span>

<span class="c1"># [87] ObjectPath ::= GraphNodePath</span>
<span class="n">ObjectPath</span> <span class="o">=</span> <span class="n">GraphNodePath</span>

<span class="c1"># [86] ObjectListPath ::= ObjectPath ( &#39;,&#39; ObjectPath )*</span>
<span class="n">ObjectListPath</span> <span class="o">=</span> <span class="n">ObjectPath</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">ObjectPath</span><span class="p">)</span>


<span class="n">GroupGraphPattern</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>


<span class="c1"># [102] Collection ::= &#39;(&#39; OneOrMore(GraphNode) &#39;)&#39;</span>
<span class="n">Collection</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">OneOrMore</span><span class="p">(</span><span class="n">GraphNode</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
<span class="n">Collection</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandCollection</span><span class="p">)</span>

<span class="c1"># [103] CollectionPath ::= &#39;(&#39; OneOrMore(GraphNodePath) &#39;)&#39;</span>
<span class="n">CollectionPath</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">OneOrMore</span><span class="p">(</span><span class="n">GraphNodePath</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
<span class="n">CollectionPath</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandCollection</span><span class="p">)</span>

<span class="c1"># [80] Object ::= GraphNode</span>
<span class="n">Object</span> <span class="o">=</span> <span class="n">GraphNode</span>

<span class="c1"># [79] ObjectList ::= Object ( &#39;,&#39; Object )*</span>
<span class="n">ObjectList</span> <span class="o">=</span> <span class="n">Object</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">Object</span><span class="p">)</span>

<span class="c1"># [83] PropertyListPathNotEmpty ::= ( VerbPath | VerbSimple ) ObjectListPath ( &#39;;&#39; ( ( VerbPath | VerbSimple ) ObjectList )? )*</span>
<span class="n">PropertyListPathNotEmpty</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">VerbPath</span> <span class="o">|</span> <span class="n">VerbSimple</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ObjectListPath</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">((</span><span class="n">VerbPath</span> <span class="o">|</span> <span class="n">VerbSimple</span><span class="p">)</span> <span class="o">+</span> <span class="n">ObjectListPath</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># [82] PropertyListPath ::= Optional(PropertyListPathNotEmpty)</span>
<span class="n">PropertyListPath</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">PropertyListPathNotEmpty</span><span class="p">)</span>

<span class="c1"># [77] PropertyListNotEmpty ::= Verb ObjectList ( &#39;;&#39; ( Verb ObjectList )? )*</span>
<span class="n">PropertyListNotEmpty</span> <span class="o">=</span> <span class="n">Verb</span> <span class="o">+</span> <span class="n">ObjectList</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Verb</span> <span class="o">+</span> <span class="n">ObjectList</span><span class="p">))</span>


<span class="c1"># [76] PropertyList ::= Optional(PropertyListNotEmpty)</span>
<span class="n">PropertyList</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">PropertyListNotEmpty</span><span class="p">)</span>

<span class="c1"># [99] BlankNodePropertyList ::= &#39;[&#39; PropertyListNotEmpty &#39;]&#39;</span>
<span class="n">BlankNodePropertyList</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">PropertyListNotEmpty</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">))</span>
<span class="n">BlankNodePropertyList</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandBNodeTriples</span><span class="p">)</span>

<span class="c1"># [101] BlankNodePropertyListPath ::= &#39;[&#39; PropertyListPathNotEmpty &#39;]&#39;</span>
<span class="n">BlankNodePropertyListPath</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span>
    <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">PropertyListPathNotEmpty</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">BlankNodePropertyListPath</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandBNodeTriples</span><span class="p">)</span>

<span class="c1"># [98] TriplesNode ::= Collection | BlankNodePropertyList</span>
<span class="n">TriplesNode</span> <span class="o">&lt;&lt;=</span> <span class="n">Collection</span> <span class="o">|</span> <span class="n">BlankNodePropertyList</span>

<span class="c1"># [100] TriplesNodePath ::= CollectionPath | BlankNodePropertyListPath</span>
<span class="n">TriplesNodePath</span> <span class="o">&lt;&lt;=</span> <span class="n">CollectionPath</span> <span class="o">|</span> <span class="n">BlankNodePropertyListPath</span>

<span class="c1"># [75] TriplesSameSubject ::= VarOrTerm PropertyListNotEmpty | TriplesNode PropertyList</span>
<span class="n">TriplesSameSubject</span> <span class="o">=</span> <span class="n">VarOrTerm</span> <span class="o">+</span> <span class="n">PropertyListNotEmpty</span> <span class="o">|</span> <span class="n">TriplesNode</span> <span class="o">+</span> <span class="n">PropertyList</span>
<span class="n">TriplesSameSubject</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandTriples</span><span class="p">)</span>

<span class="c1"># [52] TriplesTemplate ::= TriplesSameSubject ( &#39;.&#39; TriplesTemplate? )?</span>
<span class="c1"># NOTE: pyparsing.py handling of recursive rules is limited by python&#39;s recursion</span>
<span class="c1"># limit.</span>
<span class="c1"># (https://docs.python.org/3/library/sys.html#sys.setrecursionlimit)</span>
<span class="c1"># To accommodate arbitrary amounts of triples this rule is rewritten to not be</span>
<span class="c1"># recursive:</span>
<span class="c1"># [52*] TriplesTemplate ::= TriplesSameSubject ( &#39;.&#39; TriplesSameSubject? )*</span>
<span class="n">TriplesTemplate</span> <span class="o">=</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;triples&quot;</span><span class="p">,</span> <span class="n">TriplesSameSubject</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
    <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;triples&quot;</span><span class="p">,</span> <span class="n">TriplesSameSubject</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># [51] QuadsNotTriples ::= &#39;GRAPH&#39; VarOrIri &#39;{&#39; Optional(TriplesTemplate) &#39;}&#39;</span>
<span class="n">QuadsNotTriples</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;QuadsNotTriples&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GRAPH&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;term&quot;</span><span class="p">,</span> <span class="n">VarOrIri</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">TriplesTemplate</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [50] Quads ::= Optional(TriplesTemplate) ( QuadsNotTriples &#39;.&#39;? Optional(TriplesTemplate) )*</span>
<span class="n">Quads</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Quads&quot;</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">(</span><span class="n">TriplesTemplate</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;quadsNotTriples&quot;</span><span class="p">,</span> <span class="n">QuadsNotTriples</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">TriplesTemplate</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [48] QuadPattern ::= &#39;{&#39; Quads &#39;}&#39;</span>
<span class="n">QuadPattern</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;quads&quot;</span><span class="p">,</span> <span class="n">Quads</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>

<span class="c1"># [49] QuadData ::= &#39;{&#39; Quads &#39;}&#39;</span>
<span class="n">QuadData</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;quads&quot;</span><span class="p">,</span> <span class="n">Quads</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>

<span class="c1"># [81] TriplesSameSubjectPath ::= VarOrTerm PropertyListPathNotEmpty | TriplesNodePath PropertyListPath</span>
<span class="n">TriplesSameSubjectPath</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">VarOrTerm</span> <span class="o">+</span> <span class="n">PropertyListPathNotEmpty</span> <span class="o">|</span> <span class="n">TriplesNodePath</span> <span class="o">+</span> <span class="n">PropertyListPath</span>
<span class="p">)</span>
<span class="n">TriplesSameSubjectPath</span><span class="o">.</span><span class="n">setParseAction</span><span class="p">(</span><span class="n">expandTriples</span><span class="p">)</span>

<span class="c1"># [55] TriplesBlock ::= TriplesSameSubjectPath ( &#39;.&#39; Optional(TriplesBlock) )?</span>
<span class="n">TriplesBlock</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>
<span class="n">TriplesBlock</span> <span class="o">&lt;&lt;=</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;triples&quot;</span><span class="p">,</span> <span class="n">TriplesSameSubjectPath</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
    <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">TriplesBlock</span><span class="p">)</span>
<span class="p">)</span>


<span class="c1"># [66] MinusGraphPattern ::= &#39;MINUS&#39; GroupGraphPattern</span>
<span class="n">MinusGraphPattern</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;MinusGraphPattern&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MINUS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [67] GroupOrUnionGraphPattern ::= GroupGraphPattern ( &#39;UNION&#39; GroupGraphPattern )*</span>
<span class="n">GroupOrUnionGraphPattern</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;GroupOrUnionGraphPattern&quot;</span><span class="p">,</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;UNION&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)),</span>
<span class="p">)</span>


<span class="n">Expression</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>

<span class="c1"># [72] ExpressionList ::= NIL | &#39;(&#39; Expression ( &#39;,&#39; Expression )* &#39;)&#39;</span>
<span class="n">ExpressionList</span> <span class="o">=</span> <span class="n">NIL</span> <span class="o">|</span> <span class="n">Group</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">delimitedList</span><span class="p">(</span><span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">))</span>

<span class="c1"># [122] RegexExpression ::= &#39;REGEX&#39; &#39;(&#39; Expression &#39;,&#39; Expression ( &#39;,&#39; Expression )? &#39;)&#39;</span>
<span class="n">RegexExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Builtin_REGEX&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;REGEX&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;flags&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">))</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">RegexExpression</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_REGEX</span><span class="p">)</span>

<span class="c1"># [123] SubstringExpression ::= &#39;SUBSTR&#39; &#39;(&#39; Expression &#39;,&#39; Expression ( &#39;,&#39; Expression )? &#39;)&#39;</span>
<span class="n">SubstringExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Builtin_SUBSTR&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SUBSTR&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">))</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SUBSTR</span><span class="p">)</span>

<span class="c1"># [124] StrReplaceExpression ::= &#39;REPLACE&#39; &#39;(&#39; Expression &#39;,&#39; Expression &#39;,&#39; Expression ( &#39;,&#39; Expression )? &#39;)&#39;</span>
<span class="n">StrReplaceExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Builtin_REPLACE&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;REPLACE&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;replacement&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;flags&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">))</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_REPLACE</span><span class="p">)</span>

<span class="c1"># [125] ExistsFunc ::= &#39;EXISTS&#39; GroupGraphPattern</span>
<span class="n">ExistsFunc</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Builtin_EXISTS&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EXISTS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_EXISTS</span><span class="p">)</span>

<span class="c1"># [126] NotExistsFunc ::= &#39;NOT&#39; &#39;EXISTS&#39; GroupGraphPattern</span>
<span class="n">NotExistsFunc</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Builtin_NOTEXISTS&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NOT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EXISTS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_EXISTS</span><span class="p">)</span>


<span class="c1"># [127] Aggregate ::= &#39;COUNT&#39; &#39;(&#39; &#39;DISTINCT&#39;? ( &#39;*&#39; | Expression ) &#39;)&#39;</span>
<span class="c1"># | &#39;SUM&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression &#39;)&#39;</span>
<span class="c1"># | &#39;MIN&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression &#39;)&#39;</span>
<span class="c1"># | &#39;MAX&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression &#39;)&#39;</span>
<span class="c1"># | &#39;AVG&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression &#39;)&#39;</span>
<span class="c1"># | &#39;SAMPLE&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression &#39;)&#39;</span>
<span class="c1"># | &#39;GROUP_CONCAT&#39; &#39;(&#39; Optional(&#39;DISTINCT&#39;) Expression ( &#39;;&#39; &#39;SEPARATOR&#39; &#39;=&#39; String )? &#39;)&#39;</span>

<span class="n">_Distinct</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DISTINCT&quot;</span><span class="p">))</span>
<span class="n">_AggregateParams</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;distinct&quot;</span><span class="p">,</span> <span class="n">_Distinct</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

<span class="n">Aggregate</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Aggregate_Count&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;COUNT&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;distinct&quot;</span><span class="p">,</span> <span class="n">_Distinct</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span> <span class="o">|</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Aggregate_Sum&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SUM&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_AggregateParams</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Aggregate_Min&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MIN&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_AggregateParams</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Aggregate_Max&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MAX&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_AggregateParams</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Aggregate_Avg&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;AVG&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_AggregateParams</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Aggregate_Sample&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SAMPLE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_AggregateParams</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Aggregate_GroupConcat&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GROUP_CONCAT&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;distinct&quot;</span><span class="p">,</span> <span class="n">_Distinct</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SEPARATOR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;separator&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">))</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [121] BuiltInCall ::= Aggregate</span>
<span class="c1"># | &#39;STR&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;LANG&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;LANGMATCHES&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;DATATYPE&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;BOUND&#39; &#39;(&#39; Var &#39;)&#39;</span>
<span class="c1"># | &#39;IRI&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;URI&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;BNODE&#39; ( &#39;(&#39; + Expression + &#39;)&#39; | NIL )</span>
<span class="c1"># | &#39;RAND&#39; NIL</span>
<span class="c1"># | &#39;ABS&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;CEIL&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;FLOOR&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;ROUND&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;CONCAT&#39; ExpressionList</span>
<span class="c1"># | SubstringExpression</span>
<span class="c1"># | &#39;STRLEN&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | StrReplaceExpression</span>
<span class="c1"># | &#39;UCASE&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;LCASE&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;ENCODE_FOR_URI&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;CONTAINS&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;STRSTARTS&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;STRENDS&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;STRBEFORE&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;STRAFTER&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;YEAR&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;MONTH&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;DAY&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;HOURS&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;MINUTES&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;SECONDS&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;TIMEZONE&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;TZ&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;NOW&#39; NIL</span>
<span class="c1"># | &#39;UUID&#39; NIL</span>
<span class="c1"># | &#39;STRUUID&#39; NIL</span>
<span class="c1"># | &#39;MD5&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;SHA1&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;SHA256&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;SHA384&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;SHA512&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;COALESCE&#39; ExpressionList</span>
<span class="c1"># | &#39;IF&#39; &#39;(&#39; Expression &#39;,&#39; Expression &#39;,&#39; Expression &#39;)&#39;</span>
<span class="c1"># | &#39;STRLANG&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;STRDT&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;sameTerm&#39; &#39;(&#39; + Expression + &#39;,&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;isIRI&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;isURI&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;isBLANK&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;isLITERAL&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | &#39;isNUMERIC&#39; &#39;(&#39; + Expression + &#39;)&#39;</span>
<span class="c1"># | RegexExpression</span>
<span class="c1"># | ExistsFunc</span>
<span class="c1"># | NotExistsFunc</span>

<span class="n">BuiltInCall</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Aggregate</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STR&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STR</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_LANG&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LANG&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_LANG</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_LANGMATCHES&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LANGMATCHES&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_LANGMATCHES</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_DATATYPE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DATATYPE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_DATATYPE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Builtin_BOUND&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BOUND&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">Builtin_BOUND</span>
    <span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_IRI&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;IRI&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_IRI</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_URI&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;URI&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_IRI</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_BNODE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BNODE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span> <span class="o">|</span> <span class="n">NIL</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_BNODE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Builtin_RAND&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;RAND&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NIL</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_RAND</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_ABS&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ABS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_ABS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_CEIL&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CEIL&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_CEIL</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_FLOOR&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;FLOOR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_FLOOR</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_ROUND&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ROUND&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_ROUND</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_CONCAT&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CONCAT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">ExpressionList</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_CONCAT</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">SubstringExpression</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRLEN&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRLEN&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRLEN</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">StrReplaceExpression</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_UCASE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;UCASE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_UCASE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_LCASE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LCASE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_LCASE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_ENCODE_FOR_URI&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ENCODE_FOR_URI&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_ENCODE_FOR_URI</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_CONTAINS&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CONTAINS&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_CONTAINS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRSTARTS&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRSTARTS&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRSTARTS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRENDS&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRENDS&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRENDS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRBEFORE&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRBEFORE&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRBEFORE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRAFTER&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRAFTER&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRAFTER</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_YEAR&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;YEAR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_YEAR</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_MONTH&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MONTH&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_MONTH</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_DAY&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DAY&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_DAY</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_HOURS&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;HOURS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_HOURS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_MINUTES&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MINUTES&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_MINUTES</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_SECONDS&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SECONDS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SECONDS</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_TIMEZONE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;TIMEZONE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_TIMEZONE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_TZ&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;TZ&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_TZ</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Builtin_NOW&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NOW&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NIL</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_NOW</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Builtin_UUID&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;UUID&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NIL</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_UUID</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Builtin_STRUUID&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRUUID&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NIL</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRUUID</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_MD5&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MD5&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_MD5</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_SHA1&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SHA1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SHA1</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_SHA256&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SHA256&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SHA256</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_SHA384&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SHA384&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SHA384</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_SHA512&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SHA512&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_SHA512</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_COALESCE&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;COALESCE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">ExpressionList</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_COALESCE</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_IF&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;IF&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg3&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_IF</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRLANG&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRLANG&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRLANG</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_STRDT&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRDT&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_STRDT</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_sameTerm&quot;</span><span class="p">,</span>
        <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;sameTerm&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;,&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg2&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_sameTerm</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_isIRI&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;isIRI&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_isIRI</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_isURI&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;isURI&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_isIRI</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_isBLANK&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;isBLANK&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_isBLANK</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_isLITERAL&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;isLITERAL&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_isLITERAL</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;Builtin_isNUMERIC&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;isNUMERIC&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;arg&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Builtin_isNUMERIC</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">RegexExpression</span>
    <span class="o">|</span> <span class="n">ExistsFunc</span>
    <span class="o">|</span> <span class="n">NotExistsFunc</span>
<span class="p">)</span>

<span class="c1"># [71] ArgList ::= NIL | &#39;(&#39; &#39;DISTINCT&#39;? Expression ( &#39;,&#39; Expression )* &#39;)&#39;</span>
<span class="n">ArgList</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">NIL</span>
    <span class="o">|</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;distinct&quot;</span><span class="p">,</span> <span class="n">_Distinct</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">delimitedList</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">))</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<span class="p">)</span>

<span class="c1"># [128] iriOrFunction ::= iri Optional(ArgList)</span>
<span class="n">iriOrFunction</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Function&quot;</span><span class="p">,</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;iri&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span> <span class="o">+</span> <span class="n">ArgList</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>
<span class="p">)</span> <span class="o">|</span> <span class="n">iri</span>

<span class="c1"># [70] FunctionCall ::= iri ArgList</span>
<span class="n">FunctionCall</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Function&quot;</span><span class="p">,</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;iri&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span> <span class="o">+</span> <span class="n">ArgList</span><span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">Function</span><span class="p">)</span>


<span class="c1"># [120] BrackettedExpression ::= &#39;(&#39; Expression &#39;)&#39;</span>
<span class="n">BrackettedExpression</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Expression</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>

<span class="c1"># [119] PrimaryExpression ::= BrackettedExpression | BuiltInCall | iriOrFunction | RDFLiteral | NumericLiteral | BooleanLiteral | Var</span>
<span class="n">PrimaryExpression</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">BrackettedExpression</span>
    <span class="o">|</span> <span class="n">BuiltInCall</span>
    <span class="o">|</span> <span class="n">iriOrFunction</span>
    <span class="o">|</span> <span class="n">RDFLiteral</span>
    <span class="o">|</span> <span class="n">NumericLiteral</span>
    <span class="o">|</span> <span class="n">BooleanLiteral</span>
    <span class="o">|</span> <span class="n">Var</span>
<span class="p">)</span>

<span class="c1"># [118] UnaryExpression ::= &#39;!&#39; PrimaryExpression</span>
<span class="c1"># | &#39;+&#39; PrimaryExpression</span>
<span class="c1"># | &#39;-&#39; PrimaryExpression</span>
<span class="c1"># | PrimaryExpression</span>
<span class="n">UnaryExpression</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;UnaryNot&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">PrimaryExpression</span><span class="p">))</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">UnaryNot</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;UnaryPlus&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">PrimaryExpression</span><span class="p">))</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">UnaryPlus</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;UnaryMinus&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">PrimaryExpression</span><span class="p">))</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span>
        <span class="n">op</span><span class="o">.</span><span class="n">UnaryMinus</span>
    <span class="p">)</span>
    <span class="o">|</span> <span class="n">PrimaryExpression</span>
<span class="p">)</span>

<span class="c1"># [117] MultiplicativeExpression ::= UnaryExpression ( &#39;*&#39; UnaryExpression | &#39;/&#39; UnaryExpression )*</span>
<span class="n">MultiplicativeExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;MultiplicativeExpression&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">UnaryExpression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">UnaryExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">UnaryExpression</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">MultiplicativeExpression</span><span class="p">)</span>

<span class="c1"># [116] AdditiveExpression ::= MultiplicativeExpression ( &#39;+&#39; MultiplicativeExpression | &#39;-&#39; MultiplicativeExpression | ( NumericLiteralPositive | NumericLiteralNegative ) ( ( &#39;*&#39; UnaryExpression ) | ( &#39;/&#39; UnaryExpression ) )* )*</span>

<span class="c1"># NOTE: The second part of this production is there because:</span>
<span class="c1"># &quot;In signed numbers, no white space is allowed between the sign and the number. The AdditiveExpression grammar rule allows for this by covering the two cases of an expression followed by a signed number. These produce an addition or subtraction of the unsigned number as appropriate.&quot;</span>

<span class="c1"># Here (I think) this is not necessary since pyparsing doesn&#39;t separate</span>
<span class="c1"># tokenizing and parsing</span>


<span class="n">AdditiveExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;AdditiveExpression&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">MultiplicativeExpression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">MultiplicativeExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">MultiplicativeExpression</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">AdditiveExpression</span><span class="p">)</span>


<span class="c1"># [115] NumericExpression ::= AdditiveExpression</span>
<span class="n">NumericExpression</span> <span class="o">=</span> <span class="n">AdditiveExpression</span>

<span class="c1"># [114] RelationalExpression ::= NumericExpression ( &#39;=&#39; NumericExpression | &#39;!=&#39; NumericExpression | &#39;&lt;&#39; NumericExpression | &#39;&gt;&#39; NumericExpression | &#39;&lt;=&#39; NumericExpression | &#39;&gt;=&#39; NumericExpression | &#39;IN&#39; ExpressionList | &#39;NOT&#39; &#39;IN&#39; ExpressionList )?</span>
<span class="n">RelationalExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;RelationalExpression&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
        <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;!=&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">NumericExpression</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;IN&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">ExpressionList</span><span class="p">)</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span>
            <span class="s2">&quot;op&quot;</span><span class="p">,</span>
            <span class="n">Combine</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NOT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;IN&quot;</span><span class="p">),</span> <span class="n">adjacent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">joinString</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">ExpressionList</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">RelationalExpression</span><span class="p">)</span>


<span class="c1"># [113] ValueLogical ::= RelationalExpression</span>
<span class="n">ValueLogical</span> <span class="o">=</span> <span class="n">RelationalExpression</span>

<span class="c1"># [112] ConditionalAndExpression ::= ValueLogical ( &#39;&amp;&amp;&#39; ValueLogical )*</span>
<span class="n">ConditionalAndExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;ConditionalAndExpression&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">ValueLogical</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;&amp;&amp;&quot;</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">ValueLogical</span><span class="p">)),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">ConditionalAndExpression</span><span class="p">)</span>

<span class="c1"># [111] ConditionalOrExpression ::= ConditionalAndExpression ( &#39;||&#39; ConditionalAndExpression )*</span>
<span class="n">ConditionalOrExpression</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;ConditionalOrExpression&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">ConditionalAndExpression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="s2">&quot;||&quot;</span> <span class="o">+</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="n">ConditionalAndExpression</span><span class="p">)),</span>
<span class="p">)</span><span class="o">.</span><span class="n">setEvalFn</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">ConditionalOrExpression</span><span class="p">)</span>

<span class="c1"># [110] Expression ::= ConditionalOrExpression</span>
<span class="n">Expression</span> <span class="o">&lt;&lt;=</span> <span class="n">ConditionalOrExpression</span>


<span class="c1"># [69] Constraint ::= BrackettedExpression | BuiltInCall | FunctionCall</span>
<span class="n">Constraint</span> <span class="o">=</span> <span class="n">BrackettedExpression</span> <span class="o">|</span> <span class="n">BuiltInCall</span> <span class="o">|</span> <span class="n">FunctionCall</span>

<span class="c1"># [68] Filter ::= &#39;FILTER&#39; Constraint</span>
<span class="n">Filter</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Filter&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;FILTER&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">))</span>


<span class="c1"># [16] SourceSelector ::= iri</span>
<span class="n">SourceSelector</span> <span class="o">=</span> <span class="n">iri</span>

<span class="c1"># [14] DefaultGraphClause ::= SourceSelector</span>
<span class="n">DefaultGraphClause</span> <span class="o">=</span> <span class="n">SourceSelector</span>

<span class="c1"># [15] NamedGraphClause ::= &#39;NAMED&#39; SourceSelector</span>
<span class="n">NamedGraphClause</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NAMED&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;named&quot;</span><span class="p">,</span> <span class="n">SourceSelector</span><span class="p">)</span>

<span class="c1"># [13] DatasetClause ::= &#39;FROM&#39; ( DefaultGraphClause | NamedGraphClause )</span>
<span class="n">DatasetClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;DatasetClause&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;FROM&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">DefaultGraphClause</span><span class="p">)</span> <span class="o">|</span> <span class="n">NamedGraphClause</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [20] GroupCondition ::= BuiltInCall | FunctionCall | &#39;(&#39; Expression ( &#39;AS&#39; Var )? &#39;)&#39; | Var</span>
<span class="n">GroupCondition</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">BuiltInCall</span>
    <span class="o">|</span> <span class="n">FunctionCall</span>
    <span class="o">|</span> <span class="n">Comp</span><span class="p">(</span>
        <span class="s2">&quot;GroupAs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;(&quot;</span>
        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">))</span>
        <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">|</span> <span class="n">Var</span>
<span class="p">)</span>

<span class="c1"># [19] GroupClause ::= &#39;GROUP&#39; &#39;BY&#39; GroupCondition+</span>
<span class="n">GroupClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;GroupClause&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GROUP&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BY&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">OneOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span> <span class="n">GroupCondition</span><span class="p">)),</span>
<span class="p">)</span>


<span class="n">_Silent</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;silent&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SILENT&quot;</span><span class="p">)))</span>

<span class="c1"># [31] Load ::= &#39;LOAD&#39; &#39;SILENT&#39;? iri ( &#39;INTO&#39; GraphRef )?</span>
<span class="n">Load</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Load&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LOAD&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">_Silent</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;iri&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;INTO&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">GraphRef</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [32] Clear ::= &#39;CLEAR&#39; &#39;SILENT&#39;? GraphRefAll</span>
<span class="n">Clear</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CLEAR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphRefAll</span><span class="p">)</span>

<span class="c1"># [33] Drop ::= &#39;DROP&#39; _Silent GraphRefAll</span>
<span class="n">Drop</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Drop&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DROP&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphRefAll</span><span class="p">)</span>

<span class="c1"># [34] Create ::= &#39;CREATE&#39; _Silent GraphRef</span>
<span class="n">Create</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Create&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CREATE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphRef</span><span class="p">)</span>

<span class="c1"># [35] Add ::= &#39;ADD&#39; _Silent GraphOrDefault &#39;TO&#39; GraphOrDefault</span>
<span class="n">Add</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Add&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ADD&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphOrDefault</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">GraphOrDefault</span>
<span class="p">)</span>

<span class="c1"># [36] Move ::= &#39;MOVE&#39; _Silent GraphOrDefault &#39;TO&#39; GraphOrDefault</span>
<span class="n">Move</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Move&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MOVE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphOrDefault</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">GraphOrDefault</span>
<span class="p">)</span>

<span class="c1"># [37] Copy ::= &#39;COPY&#39; _Silent GraphOrDefault &#39;TO&#39; GraphOrDefault</span>
<span class="n">Copy</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Copy&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;COPY&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_Silent</span> <span class="o">+</span> <span class="n">GraphOrDefault</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">GraphOrDefault</span>
<span class="p">)</span>

<span class="c1"># [38] InsertData ::= &#39;INSERT DATA&#39; QuadData</span>
<span class="n">InsertData</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;InsertData&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;INSERT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DATA&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">QuadData</span><span class="p">)</span>

<span class="c1"># [39] DeleteData ::= &#39;DELETE DATA&#39; QuadData</span>
<span class="n">DeleteData</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;DeleteData&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DELETE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DATA&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">QuadData</span><span class="p">)</span>

<span class="c1"># [40] DeleteWhere ::= &#39;DELETE WHERE&#39; QuadPattern</span>
<span class="n">DeleteWhere</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;DeleteWhere&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DELETE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WHERE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">QuadPattern</span><span class="p">)</span>

<span class="c1"># [42] DeleteClause ::= &#39;DELETE&#39; QuadPattern</span>
<span class="n">DeleteClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;DeleteClause&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DELETE&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">QuadPattern</span><span class="p">)</span>

<span class="c1"># [43] InsertClause ::= &#39;INSERT&#39; QuadPattern</span>
<span class="n">InsertClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;InsertClause&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;INSERT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">QuadPattern</span><span class="p">)</span>

<span class="c1"># [44] UsingClause ::= &#39;USING&#39; ( iri | &#39;NAMED&#39; iri )</span>
<span class="n">UsingClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;UsingClause&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;USING&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)</span> <span class="o">|</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NAMED&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;named&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">)),</span>
<span class="p">)</span>

<span class="c1"># [41] Modify ::= ( &#39;WITH&#39; iri )? ( DeleteClause Optional(InsertClause) | InsertClause ) ZeroOrMore(UsingClause) &#39;WHERE&#39; GroupGraphPattern</span>
<span class="n">Modify</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Modify&quot;</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WITH&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;withClause&quot;</span><span class="p">,</span> <span class="n">iri</span><span class="p">))</span>
    <span class="o">+</span> <span class="p">(</span>
        <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;delete&quot;</span><span class="p">,</span> <span class="n">DeleteClause</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">InsertClause</span><span class="p">))</span>
        <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="n">InsertClause</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;using&quot;</span><span class="p">,</span> <span class="n">UsingClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WHERE&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;where&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">),</span>
<span class="p">)</span>


<span class="c1"># [30] Update1 ::= Load | Clear | Drop | Add | Move | Copy | Create | InsertData | DeleteData | DeleteWhere | Modify</span>
<span class="n">Update1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Load</span>
    <span class="o">|</span> <span class="n">Clear</span>
    <span class="o">|</span> <span class="n">Drop</span>
    <span class="o">|</span> <span class="n">Add</span>
    <span class="o">|</span> <span class="n">Move</span>
    <span class="o">|</span> <span class="n">Copy</span>
    <span class="o">|</span> <span class="n">Create</span>
    <span class="o">|</span> <span class="n">InsertData</span>
    <span class="o">|</span> <span class="n">DeleteData</span>
    <span class="o">|</span> <span class="n">DeleteWhere</span>
    <span class="o">|</span> <span class="n">Modify</span>
<span class="p">)</span>


<span class="c1"># [63] InlineDataOneVar ::= Var &#39;{&#39; ZeroOrMore(DataBlockValue) &#39;}&#39;</span>
<span class="n">InlineDataOneVar</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">DataBlockValue</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
<span class="p">)</span>

<span class="c1"># [64] InlineDataFull ::= ( NIL | &#39;(&#39; ZeroOrMore(Var) &#39;)&#39; ) &#39;{&#39; ( &#39;(&#39; ZeroOrMore(DataBlockValue) &#39;)&#39; | NIL )* &#39;}&#39;</span>
<span class="n">InlineDataFull</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">NIL</span> <span class="o">|</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;{&quot;</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span>
            <span class="s2">&quot;value&quot;</span><span class="p">,</span>
            <span class="n">Group</span><span class="p">(</span><span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">DataBlockValue</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="n">NIL</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
<span class="p">)</span>

<span class="c1"># [62] DataBlock ::= InlineDataOneVar | InlineDataFull</span>
<span class="n">DataBlock</span> <span class="o">=</span> <span class="n">InlineDataOneVar</span> <span class="o">|</span> <span class="n">InlineDataFull</span>


<span class="c1"># [28] ValuesClause ::= ( &#39;VALUES&#39; DataBlock )?</span>
<span class="n">ValuesClause</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;valuesClause&quot;</span><span class="p">,</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;ValuesClause&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;VALUES&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DataBlock</span><span class="p">))</span>
<span class="p">)</span>


<span class="c1"># [74] ConstructTriples ::= TriplesSameSubject ( &#39;.&#39; Optional(ConstructTriples) )?</span>
<span class="n">ConstructTriples</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>
<span class="n">ConstructTriples</span> <span class="o">&lt;&lt;=</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="n">TriplesSameSubject</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
    <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">ConstructTriples</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [73] ConstructTemplate ::= &#39;{&#39; Optional(ConstructTriples) &#39;}&#39;</span>
<span class="n">ConstructTemplate</span> <span class="o">=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">ConstructTriples</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>


<span class="c1"># [57] OptionalGraphPattern ::= &#39;OPTIONAL&#39; GroupGraphPattern</span>
<span class="n">OptionalGraphPattern</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;OptionalGraphPattern&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;OPTIONAL&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [58] GraphGraphPattern ::= &#39;GRAPH&#39; VarOrIri GroupGraphPattern</span>
<span class="n">GraphGraphPattern</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;GraphGraphPattern&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GRAPH&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;term&quot;</span><span class="p">,</span> <span class="n">VarOrIri</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [59] ServiceGraphPattern ::= &#39;SERVICE&#39; _Silent VarOrIri GroupGraphPattern</span>
<span class="n">ServiceGraphPattern</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;ServiceGraphPattern&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SERVICE&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">_Silent</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;term&quot;</span><span class="p">,</span> <span class="n">VarOrIri</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;graph&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [60] Bind ::= &#39;BIND&#39; &#39;(&#39; Expression &#39;AS&#39; Var &#39;)&#39;</span>
<span class="n">Bind</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;Bind&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BIND&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;(&quot;</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span>
    <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [61] InlineData ::= &#39;VALUES&#39; DataBlock</span>
<span class="n">InlineData</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;InlineData&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;VALUES&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DataBlock</span><span class="p">)</span>

<span class="c1"># [56] GraphPatternNotTriples ::= GroupOrUnionGraphPattern | OptionalGraphPattern | MinusGraphPattern | GraphGraphPattern | ServiceGraphPattern | Filter | Bind | InlineData</span>
<span class="n">GraphPatternNotTriples</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">GroupOrUnionGraphPattern</span>
    <span class="o">|</span> <span class="n">OptionalGraphPattern</span>
    <span class="o">|</span> <span class="n">MinusGraphPattern</span>
    <span class="o">|</span> <span class="n">GraphGraphPattern</span>
    <span class="o">|</span> <span class="n">ServiceGraphPattern</span>
    <span class="o">|</span> <span class="n">Filter</span>
    <span class="o">|</span> <span class="n">Bind</span>
    <span class="o">|</span> <span class="n">InlineData</span>
<span class="p">)</span>

<span class="c1"># [54] GroupGraphPatternSub ::= Optional(TriplesBlock) ( GraphPatternNotTriples &#39;.&#39;? Optional(TriplesBlock) )*</span>
<span class="n">GroupGraphPatternSub</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;GroupGraphPatternSub&quot;</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;TriplesBlock&quot;</span><span class="p">,</span> <span class="n">TriplesBlock</span><span class="p">)))</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span>
        <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">GraphPatternNotTriples</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;TriplesBlock&quot;</span><span class="p">,</span> <span class="n">TriplesBlock</span><span class="p">)))</span>
    <span class="p">),</span>
<span class="p">)</span>


<span class="c1"># ----------------</span>
<span class="c1"># [22] HavingCondition ::= Constraint</span>
<span class="n">HavingCondition</span> <span class="o">=</span> <span class="n">Constraint</span>

<span class="c1"># [21] HavingClause ::= &#39;HAVING&#39; HavingCondition+</span>
<span class="n">HavingClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;HavingClause&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;HAVING&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">OneOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span> <span class="n">HavingCondition</span><span class="p">)),</span>
<span class="p">)</span>

<span class="c1"># [24] OrderCondition ::= ( ( &#39;ASC&#39; | &#39;DESC&#39; ) BrackettedExpression )</span>
<span class="c1"># | ( Constraint | Var )</span>
<span class="n">OrderCondition</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;OrderCondition&quot;</span><span class="p">,</span>
    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;order&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ASC&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DESC&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">BrackettedExpression</span><span class="p">)</span>
    <span class="o">|</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Constraint</span> <span class="o">|</span> <span class="n">Var</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [23] OrderClause ::= &#39;ORDER&#39; &#39;BY&#39; OneOrMore(OrderCondition)</span>
<span class="n">OrderClause</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;OrderClause&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ORDER&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BY&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">OneOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span> <span class="n">OrderCondition</span><span class="p">)),</span>
<span class="p">)</span>

<span class="c1"># [26] LimitClause ::= &#39;LIMIT&#39; INTEGER</span>
<span class="n">LimitClause</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LIMIT&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span> <span class="n">INTEGER</span><span class="p">)</span>

<span class="c1"># [27] OffsetClause ::= &#39;OFFSET&#39; INTEGER</span>
<span class="n">OffsetClause</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;OFFSET&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="n">INTEGER</span><span class="p">)</span>

<span class="c1"># [25] LimitOffsetClauses ::= LimitClause Optional(OffsetClause) | OffsetClause Optional(LimitClause)</span>
<span class="n">LimitOffsetClauses</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;LimitOffsetClauses&quot;</span><span class="p">,</span>
    <span class="n">LimitClause</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">OffsetClause</span><span class="p">)</span> <span class="o">|</span> <span class="n">OffsetClause</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">LimitClause</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [18] SolutionModifier ::= GroupClause? HavingClause? OrderClause? LimitOffsetClauses?</span>
<span class="n">SolutionModifier</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;groupby&quot;</span><span class="p">,</span> <span class="n">GroupClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;having&quot;</span><span class="p">,</span> <span class="n">HavingClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;orderby&quot;</span><span class="p">,</span> <span class="n">OrderClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;limitoffset&quot;</span><span class="p">,</span> <span class="n">LimitOffsetClauses</span><span class="p">))</span>
<span class="p">)</span>


<span class="c1"># [9] SelectClause ::= &#39;SELECT&#39; ( &#39;DISTINCT&#39; | &#39;REDUCED&#39; )? ( ( Var | ( &#39;(&#39; Expression &#39;AS&#39; Var &#39;)&#39; ) )+ | &#39;*&#39; )</span>
<span class="n">SelectClause</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SELECT&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;modifier&quot;</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DISTINCT&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;REDUCED&quot;</span><span class="p">)))</span>
    <span class="o">+</span> <span class="p">(</span>
        <span class="n">OneOrMore</span><span class="p">(</span>
            <span class="n">ParamList</span><span class="p">(</span>
                <span class="s2">&quot;projection&quot;</span><span class="p">,</span>
                <span class="n">Comp</span><span class="p">(</span>
                    <span class="s2">&quot;vars&quot;</span><span class="p">,</span>
                    <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span>
                        <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;expr&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;AS&quot;</span><span class="p">)</span>
                        <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;evar&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                    <span class="p">),</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="o">|</span> <span class="s2">&quot;*&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># [17] WhereClause ::= &#39;WHERE&#39;? GroupGraphPattern</span>
<span class="n">WhereClause</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WHERE&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;where&quot;</span><span class="p">,</span> <span class="n">GroupGraphPattern</span><span class="p">)</span>

<span class="c1"># [8] SubSelect ::= SelectClause WhereClause SolutionModifier ValuesClause</span>
<span class="n">SubSelect</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;SubSelect&quot;</span><span class="p">,</span> <span class="n">SelectClause</span> <span class="o">+</span> <span class="n">WhereClause</span> <span class="o">+</span> <span class="n">SolutionModifier</span> <span class="o">+</span> <span class="n">ValuesClause</span>
<span class="p">)</span>

<span class="c1"># [53] GroupGraphPattern ::= &#39;{&#39; ( SubSelect | GroupGraphPatternSub ) &#39;}&#39;</span>
<span class="n">GroupGraphPattern</span> <span class="o">&lt;&lt;=</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">SubSelect</span> <span class="o">|</span> <span class="n">GroupGraphPatternSub</span><span class="p">)</span> <span class="o">+</span> <span class="n">Suppress</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>

<span class="c1"># [7] SelectQuery ::= SelectClause DatasetClause* WhereClause SolutionModifier</span>
<span class="n">SelectQuery</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;SelectQuery&quot;</span><span class="p">,</span>
    <span class="n">SelectClause</span>
    <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;datasetClause&quot;</span><span class="p">,</span> <span class="n">DatasetClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">WhereClause</span>
    <span class="o">+</span> <span class="n">SolutionModifier</span>
    <span class="o">+</span> <span class="n">ValuesClause</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [10] ConstructQuery ::= &#39;CONSTRUCT&#39; ( ConstructTemplate DatasetClause* WhereClause SolutionModifier | DatasetClause* &#39;WHERE&#39; &#39;{&#39; TriplesTemplate? &#39;}&#39; SolutionModifier )</span>
<span class="c1"># NOTE: The CONSTRUCT WHERE alternative has unnecessarily many Comp/Param pairs</span>
<span class="c1"># to allow it to through the same algebra translation process</span>
<span class="n">ConstructQuery</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;ConstructQuery&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CONSTRUCT&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="p">(</span>
        <span class="n">ConstructTemplate</span>
        <span class="o">+</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;datasetClause&quot;</span><span class="p">,</span> <span class="n">DatasetClause</span><span class="p">))</span>
        <span class="o">+</span> <span class="n">WhereClause</span>
        <span class="o">+</span> <span class="n">SolutionModifier</span>
        <span class="o">+</span> <span class="n">ValuesClause</span>
        <span class="o">|</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;datasetClause&quot;</span><span class="p">,</span> <span class="n">DatasetClause</span><span class="p">))</span>
        <span class="o">+</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WHERE&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;{&quot;</span>
        <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
            <span class="n">Param</span><span class="p">(</span>
                <span class="s2">&quot;where&quot;</span><span class="p">,</span>
                <span class="n">Comp</span><span class="p">(</span>
                    <span class="s2">&quot;FakeGroupGraphPatten&quot;</span><span class="p">,</span>
                    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;part&quot;</span><span class="p">,</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;TriplesBlock&quot;</span><span class="p">,</span> <span class="n">TriplesTemplate</span><span class="p">)),</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
        <span class="o">+</span> <span class="n">SolutionModifier</span>
        <span class="o">+</span> <span class="n">ValuesClause</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># [12] AskQuery ::= &#39;ASK&#39; DatasetClause* WhereClause SolutionModifier</span>
<span class="n">AskQuery</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;AskQuery&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ASK&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;datasetClause&quot;</span><span class="p">,</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">DatasetClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">WhereClause</span>
    <span class="o">+</span> <span class="n">SolutionModifier</span>
    <span class="o">+</span> <span class="n">ValuesClause</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [11] DescribeQuery ::= &#39;DESCRIBE&#39; ( VarOrIri+ | &#39;*&#39; ) DatasetClause* WhereClause? SolutionModifier</span>
<span class="n">DescribeQuery</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span>
    <span class="s2">&quot;DescribeQuery&quot;</span><span class="p">,</span>
    <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;DESCRIBE&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="p">(</span><span class="n">OneOrMore</span><span class="p">(</span><span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="n">VarOrIri</span><span class="p">))</span> <span class="o">|</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Param</span><span class="p">(</span><span class="s2">&quot;datasetClause&quot;</span><span class="p">,</span> <span class="n">ZeroOrMore</span><span class="p">(</span><span class="n">DatasetClause</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="n">WhereClause</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">SolutionModifier</span>
    <span class="o">+</span> <span class="n">ValuesClause</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># [29] Update ::= Prologue ( Update1 ( &#39;;&#39; Update )? )?</span>
<span class="n">Update</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">()</span>
<span class="n">Update</span> <span class="o">&lt;&lt;=</span> <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;prologue&quot;</span><span class="p">,</span> <span class="n">Prologue</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span>
    <span class="n">ParamList</span><span class="p">(</span><span class="s2">&quot;request&quot;</span><span class="p">,</span> <span class="n">Update1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Optional</span><span class="p">(</span><span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">Update</span><span class="p">)</span>
<span class="p">)</span>


<span class="c1"># [2] Query ::= Prologue</span>
<span class="c1"># ( SelectQuery | ConstructQuery | DescribeQuery | AskQuery )</span>
<span class="c1"># ValuesClause</span>
<span class="c1"># NOTE: ValuesClause was moved to individual queries</span>
<span class="n">Query</span> <span class="o">=</span> <span class="n">Prologue</span> <span class="o">+</span> <span class="p">(</span><span class="n">SelectQuery</span> <span class="o">|</span> <span class="n">ConstructQuery</span> <span class="o">|</span> <span class="n">DescribeQuery</span> <span class="o">|</span> <span class="n">AskQuery</span><span class="p">)</span>

<span class="c1"># [3] UpdateUnit ::= Update</span>
<span class="n">UpdateUnit</span> <span class="o">=</span> <span class="n">Comp</span><span class="p">(</span><span class="s2">&quot;Update&quot;</span><span class="p">,</span> <span class="n">Update</span><span class="p">)</span>

<span class="c1"># [1] QueryUnit ::= Query</span>
<span class="n">QueryUnit</span> <span class="o">=</span> <span class="n">Query</span>

<span class="n">QueryUnit</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">restOfLine</span><span class="p">)</span>
<span class="n">UpdateUnit</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">restOfLine</span><span class="p">)</span>


<span class="n">expandUnicodeEscapes_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u([0-9a-f]</span><span class="si">{4}</span><span class="s2">(?:[0-9a-f]</span><span class="si">{4}</span><span class="s2">)?)&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>


<div class="viewcode-block" id="expandUnicodeEscapes"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.expandUnicodeEscapes">[docs]</a><span class="k">def</span> <span class="nf">expandUnicodeEscapes</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The syntax of the SPARQL Query Language is expressed over code points in Unicode [UNICODE]. The encoding is always UTF-8 [RFC3629].</span>
<span class="sd">    Unicode code points may also be expressed using an \ uXXXX (U+0 to U+FFFF) or \ UXXXXXXXX syntax (for U+10000 onwards) where X is a hexadecimal digit [0-9A-F]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid unicode code point: &quot;</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">expandUnicodeEscapes_re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span></div>


<div class="viewcode-block" id="parseQuery"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.parseQuery">[docs]</a><span class="k">def</span> <span class="nf">parseQuery</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">expandUnicodeEscapes</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Query</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">parseAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="parseUpdate"><a class="viewcode-back" href="../../../../apidocs/rdflib.plugins.sparql.html#rdflib.plugins.sparql.parser.parseUpdate">[docs]</a><span class="k">def</span> <span class="nf">parseUpdate</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">expandUnicodeEscapes</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">UpdateUnit</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">parseAll</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">Query</span><span class="o">.</span><span class="n">parseString</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Syntax Tree:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ParseException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">column</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/RDFlib.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">rdflib 6.2.0-alpha documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">rdflib.plugins.sparql.parser</a></li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2009 - 2021, RDFLib Team.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.3.2.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>





  </body>
</html>